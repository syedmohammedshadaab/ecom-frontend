<div class="container mt-5" @fadeSlide>
  <!-- ðŸ”” Toast Notification -->
  <div
    class="toast-container"
    @fadeSlide
    [ngClass]="{
      show: showToast,
      success: toastType === 'success',
      error: toastType === 'error'
    }"
  >
    <div
      class="toast-content d-flex align-items-center justify-content-between"
    >
      <div class="toast-body">{{ toastMessage }}</div>
      <button
        type="button"
        class="btn-close btn-close-white ms-3"
        (click)="showToast = false"
        aria-label="Close"
      ></button>
    </div>
  </div>

  <div class="row" @fadeSlide>
    <!-- ðŸ–¼ï¸ Left Section: Image Carousel -->
    <div class="col-md-6 text-center position-relative" @fadeSlide>
      <div id="comboCarousel" class="position-relative">
        <!-- Main Image -->
        <img
          [src]="
            imageList[currentImageIndex] &&
            imageList[currentImageIndex].trim() !== ''
              ? imageList[currentImageIndex]
              : 'https://placehold.co/400x400?text=No+Image'
          "
          class="img-fluid rounded shadow-sm main-preview"
          alt="{{ combo?.name }}"
          style="max-width: 100%; height: auto; border-radius: 15px"
          (click)="previewImage(imageList[currentImageIndex])"
        />

        <!-- Left Arrow -->
        <button
          class="carousel-arrow left-arrow"
          (click)="prevImage()"
          aria-label="Previous"
        >
          <i class="bi bi-chevron-left"></i>
        </button>

        <!-- Right Arrow -->
        <button
          class="carousel-arrow right-arrow"
          (click)="nextImage()"
          aria-label="Next"
        >
          <i class="bi bi-chevron-right"></i>
        </button>
      </div>

      <!-- Thumbnails -->
      <div class="d-flex justify-content-center gap-3 flex-wrap mt-3">
        <img
          *ngFor="let img of imageList; let i = index"
          [src]="
            img && img.trim() !== ''
              ? img
              : 'https://placehold.co/85x85?text=No+Image'
          "
          (click)="setImage(i)"
          class="thumbnail-img rounded shadow-sm"
          [class.selected]="i === currentImageIndex"
          alt="Thumbnail {{ i + 1 }}"
          style="width: 85px; height: 85px; object-fit: cover; cursor: pointer"
        />
      </div>
    </div>

    <!-- ðŸ§´ Right Section: Combo Details -->
    <div class="col-md-6 text-start mt-4 mt-md-0 position-relative" @fadeSlide>
      <h2 class="fw-bold mb-3">{{ combo?.name }}</h2>
      <p class="text-muted">{{ combo?.description }}</p>

      <p><strong>Gender:</strong> {{ combo?.gender }}</p>

      <p>
        <strong>Price:</strong>
        {{ combo?.price | currency : "INR" }}
      </p>

      <div class="d-flex align-items-center gap-3 mt-3">
      <!-- â­ UPDATED BUTTON WITH SPINNER -->
      <button
        class="btn btn-outline-primary me-2 d-flex align-items-center gap-2"
        [disabled]="isAddingToCart"
        (click)="addToCart(combo)"
      >
        <span *ngIf="!isAddingToCart">
          <i class="bi bi-cart-plus me-1"></i> Add to Cart
        </span>

        <!-- Spinner -->
        <div
          *ngIf="isAddingToCart"
          class="spinner-border spinner-border-sm"
          role="status"
        ></div>
        <span *ngIf="isAddingToCart">Adding...</span>
      </button>

      <button class="btn btn-outline-secondary" routerLink="/combo">
        <i class="bi bi-arrow-left me-1"></i> Back
      </button>
    </div>
  </div>
</div>
  <!-- ðŸª„ Image Preview Modal -->
  <div
    class="modal fade"
    id="imageModal"
    tabindex="-1"
    aria-labelledby="imageModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content bg-transparent border-0 text-center">
        <img
          [src]="selectedImage"
          class="img-fluid rounded-4 shadow-lg"
          alt="Preview"
          style="max-height: 80vh"
        />
      </div>
    </div>
  </div>

  <!-- ðŸŒ¸ Similar Combos Section -->
  <div class="mt-5" *ngIf="similarCombos.length > 0" @fadeSlide>
    <h4 class="fw-bold mb-4 text-center">You may also like</h4>

    <div class="row similar-combos-row">
      <div
        class="col-md-3 mb-4 similar-combo-col"
        *ngFor="let c of similarCombos"
        (click)="goToDetails(c.cid)"
        style="cursor: pointer"
        @fadeSlide
      >
        <div class="card h-100 shadow-sm border-0 hover-card position-relative">
          <img
            [src]="
              c.imageurl && c.imageurl.trim() !== ''
                ? c.imageurl
                : c.imageUrl && c.imageUrl.trim() !== ''
                ? c.imageUrl
                : 'https://placehold.co/300x300?text=No+Image'
            "
            class="card-img-top rounded"
            alt="{{ c.name }}"
            style="height: 250px; object-fit: cover"
          />
          <div class="card-body text-center">
            <h6 class="fw-semibold">{{ c.name }}</h6>
            <p class="text-muted small mb-1">{{ c.gender }}</p>
            <p class="fw-bold mb-0">{{ c.price | currency : "INR" }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- No Similar Combos -->
  <div class="text-center text-muted mt-5" *ngIf="similarCombos.length === 0" @fadeSlide>
    <i class="bi bi-emoji-frown fs-3 d-block mb-2"></i>
    No similar combos found.
  </div>
</div>
